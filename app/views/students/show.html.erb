<div class="student-show-container" data="<%=@student.id%>">

	<!-- data visualizations -->
	<div class="student-info-container">
		<div class="student-photo">
			<%= image_tag "2801ph.jpeg" %><a href="#" class="search-icon"><i class="fas fa-search-plus"></i></a>
		</div>
		<div class="student-info">
			<h2><%= @student.lastfirst %></h2>
			 <p>Student Number: <%= @student.student_number %></p>
			 <p>Grade: <%= @student.grade_level %></p>
		</div>
		<div class="student-donut">
			<h5>All Standards for 18-19</h5>
			<div class="student-donut-wrapper">
				<div class="student-doughnut-homs"><canvas id="student-doughnut-homs"></canvas></div>
				<div class="student-doughnut-homs"><canvas id="student-doughnut-standards"></canvas></div>
			</div>
		</div>
	</div>

	<div class="student-nav-container">
		<ul>
			<li><a class="student-comments-link" href="#">Comments</a></li>
			<li><a class="schedule-matrix-link" href='#'>Schedule Matrix</a></li>
			<!-- <li><a class="schedule-bell-link" href='#'>Bell Schedule</a></li> -->
			<li><a class="student-sections-link" href='#'>Sections</a></li>
			<li><a class="student-map-link" href='#'>Map Data</a></li>
			<li><%=link_to "Writing Sample", asset_path("student-writing-sample.pdf"), target: "_blank"%></li>
		</ul>
	</div>

	<div class="student-data-container">
		<!-- <canvas id="map-chart"></canvas> -->
		<%= render partial: 'comments' %>
	</div>

		
<%= content_tag :div, class: "student_list", id: "studentshow", data: {homs: @all_homs, standards: @all_standards} do %>
<%end%>



<div class="hover_bkgr_fricc">
   
</div>


<script type="text/javascript">
$(function(){

//BEGIN Global variable declarations ///////////////////////////////////////////////

	let student_id = $('.student-show-container').attr("data");
	let all_homs = $('#studentshow').data('homs');
	let all_standards = $('#studentshow').data('standards');
	let ND = all_homs.filter(function(grade){return grade.grade === "0"}).length
	let B = all_homs.filter(function(grade){return grade.grade === "1"}).length
	let P = all_homs.filter(function(grade){return grade.grade === "2"}).length
	let M = all_homs.filter(function(grade){return grade.grade === "3"}).length
	let E = all_homs.filter(function(grade){return grade.grade === "4"}).length

	let NDs = all_standards.filter(function(grade){return grade.grade === "0"}).length
	let Bs = all_standards.filter(function(grade){return grade.grade === "1"}).length
	let Ps = all_standards.filter(function(grade){return grade.grade === "2"}).length
	let Ms = all_standards.filter(function(grade){return grade.grade === "3"}).length
	let Es = all_standards.filter(function(grade){return grade.grade === "4"}).length

	let colors = {
    	0:"#FBE2E62",
        1:"#A8271E",
        2:"#F8DA06",
        3:"#249D3D",
        4:"#007CC6"
    }
	
//END Global variable declarations ////////////////////////////////////////////////
//BEGIN Doughnut Standards ////////////////////////////////////////////////////////
	let doughnutDiv = $('#student-doughnut-standards');
	let dataS = {
		    datasets: [{
		        data: [NDs, Bs, Ps, Ms, Es],
		        label: "S1",
                backgroundColor: ['#FBE2E62','#A8271E', '#F8DA06', '#249D3D','#007CC6'], 
                borderColor: '#FFFFFF',
                borderWidth: 1
		    }],

		    // These labels appear in the legend and in the tooltips when hovering different arcs
		    labels: ['ND','B','P','M','E']
		};

	let doughnutChart = new Chart(doughnutDiv, {
	    type: 'doughnut',
	    data: dataS,
	    options: {
	    	legend: {
	    		position: 'right',
	    		display: true
	    	},
	    	title: {
	    		display: true,
	    		text: `Academic Standards (${all_standards.length})`,
	    		position: 'top'
	    	}

	    }
	});
// END Standards Donut /////////////////////////////////////////////////////////////

// BEGIN HOMs Donut //////////////////////////////////////////////////////////////// 
	let homsDoughnutDiv = $('#student-doughnut-homs');
	let data = {
		    datasets: [{
		        data: [ND, B, P, M, E],
		        label: "S1",
                backgroundColor: ['#FBE2E62','#A8271E', '#F8DA06', '#249D3D','#007CC6'], 
                borderColor: '#FFFFFF',
                borderWidth: 1
		    }],

		    // These labels appear in the legend and in the tooltips when hovering different arcs
		    labels: ['ND','B','P','M','E']
		};

	let homsDoughnutChart = new Chart(homsDoughnutDiv, {
	    type: 'doughnut',
	    data: data,
	    options: {
	    	legend: {
	    		position: 'right',
	    		display: false
	    	},
	    	title: {
	    		display: true,
	    		text: `Habits of Mind (${all_homs.length})`,
	    		position: 'top'
	    	}

	    }
	});



// END HOMs Donut /////////////////////////////////////////////////////////////
// BEGIN Listener Attachments //////////////////////////////////////////////////////
	$('.schedule-matrix-link').on("click", function(event){
		event.preventDefault()
		
		$.get(`/students/${student_id}/schedule`, function(response){
			$('.student-data-container').html(response)
		})
	});

	$('.student-map-link').on("click", function(event){
		event.preventDefault();
		$.get(`/students/${student_id}/map`, function(response){
			$('.student-data-container').html(response)
		})
	})

	$('.student-sections-link').on("click", function(event){
		event.preventDefault();
		$.get(`/students/${student_id}/sections`, function(response){
			$('.student-data-container').html(response)
		}).done(function(data){
			$('.student-section-link').on("click", function(event){
				event.preventDefault();
				let section_id = $(this).attr('id')
				$.get(`/students/${student_id}/sections/${section_id}`, function(response){
					$('.student-data-container').html(response)
				})
			});
		})
	})

	$('.student-comments-link').on("click", function(event){
		event.preventDefault();
		$.get(`/students/${student_id}/comments`, function(response){
			$('.student-data-container').html(response);
		})
	})


// END Listener Attachments ///////////////////////////////////////////////
});
</script>
